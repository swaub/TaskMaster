<Window x:Class="TaskMaster.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:TaskMaster"
        mc:Ignorable="d"
        Title="TaskMaster - Personal Task Management" Height="700" Width="1200"
        WindowStartupLocation="CenterScreen"
        KeyDown="MainWindow_KeyDown">
    
    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
        <local:InverseBooleanToVisibilityConverter x:Key="InverseBooleanToVisibilityConverter"/>
        <local:StringToVisibilityConverter x:Key="StringToVisibilityConverter"/>
        
        <Style x:Key="HeaderTextStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Margin" Value="5"/>
        </Style>
        
        <Style x:Key="SectionHeaderStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Margin" Value="5,10,5,5"/>
        </Style>
        
        <Style x:Key="CardStyle" TargetType="Border">
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="#E0E0E0"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="5"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="Padding" Value="10"/>
        </Style>
        
        <Style x:Key="EmptyStateTextStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontStyle" Value="Italic"/>
            <Setter Property="Foreground" Value="Gray"/>
            <Setter Property="HorizontalAlignment" Value="Center"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Margin" Value="20"/>
        </Style>
        
        <Style x:Key="ValidationTextStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="10"/>
            <Setter Property="Foreground" Value="Red"/>
            <Setter Property="Margin" Value="0,2,0,0"/>
        </Style>
    </Window.Resources>
    
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="2*"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        
        <Border Grid.Row="0" Grid.ColumnSpan="2" Style="{StaticResource CardStyle}" Margin="0,0,0,10">
            <StackPanel>
                <TextBlock Text="TaskMaster" Style="{StaticResource HeaderTextStyle}" HorizontalAlignment="Center"/>
                
                <Grid Margin="0,10,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <StackPanel Grid.Column="0" Orientation="Horizontal" Margin="5">
                        <Label Content="_Sort by:" VerticalAlignment="Center" Margin="0,0,5,0" Target="{Binding ElementName=SortComboBox}"/>
                        <ComboBox x:Name="SortComboBox" 
                                  ItemsSource="{Binding SortOptions}" 
                                  SelectedItem="{Binding SelectedSort}" 
                                  Width="120"
                                  TabIndex="1"
                                  AutomationProperties.Name="Sort Options"
                                  AutomationProperties.HelpText="Select how to sort the task list"/>
                    </StackPanel>
                    
                    <StackPanel Grid.Column="1" Orientation="Horizontal" Margin="5">
                        <Label Content="_Category:" VerticalAlignment="Center" Margin="0,0,5,0" Target="{Binding ElementName=CategoryComboBox}"/>
                        <ComboBox x:Name="CategoryComboBox"
                                  ItemsSource="{Binding AllCategories}" 
                                  SelectedItem="{Binding SelectedCategory}" 
                                  Width="120"
                                  TabIndex="2"
                                  AutomationProperties.Name="Category Filter"
                                  AutomationProperties.HelpText="Filter tasks by category"/>
                    </StackPanel>
                    
                    <Button Grid.Column="2" Content="_Reset Routines" 
                            Command="{Binding ResetRoutinesCommand}" 
                            Margin="5" Padding="10,5"
                            TabIndex="3"
                            AutomationProperties.Name="Reset Routines"
                            AutomationProperties.HelpText="Mark all daily routines as incomplete"
                            ToolTip="Reset all daily routines to incomplete status (Ctrl+R)"/>
                </Grid>
            </StackPanel>
        </Border>
        
        <Border Grid.Row="1" Grid.Column="0" Style="{StaticResource CardStyle}">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <TextBlock Grid.Row="0" Text="Tasks" Style="{StaticResource SectionHeaderStyle}"/>
                
                <TabControl Grid.Row="1" Margin="0,5,0,0" TabIndex="4">
                    <TabItem Header="List View" TabIndex="5">
                        <Grid>
                            <ScrollViewer Visibility="{Binding HasDisplayedTasks, Converter={StaticResource BooleanToVisibilityConverter}}">
                                <ItemsControl ItemsSource="{Binding DisplayedTasks}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border Background="WhiteSmoke" BorderBrush="Gray" BorderThickness="1" 
                                                CornerRadius="3" Margin="2" Padding="8">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="Auto"/>
                                                </Grid.RowDefinitions>
                                                
                                                <CheckBox Grid.Column="0" Grid.RowSpan="2" 
                                                          IsChecked="{Binding IsCompleted}" 
                                                          Command="{Binding DataContext.ToggleTaskCompletionCommand, 
                                                                   RelativeSource={RelativeSource AncestorType=Window}}"
                                                          CommandParameter="{Binding}"
                                                          VerticalAlignment="Center" Margin="0,0,8,0"/>
                                                
                                                <TextBlock Grid.Column="1" Grid.Row="0" Text="{Binding Name}" 
                                                           FontWeight="Bold" FontSize="14"/>
                                                <TextBlock Grid.Column="1" Grid.Row="1" Text="{Binding Description}" 
                                                           Margin="0,2,0,0" TextWrapping="Wrap" Opacity="0.7"/>
                                                
                                                <StackPanel Grid.Column="2" Grid.RowSpan="2" Orientation="Vertical" 
                                                            VerticalAlignment="Center" Margin="5,0">
                                                    <TextBlock Text="{Binding Priority, StringFormat='Priority: {0}'}" 
                                                               FontSize="12" HorizontalAlignment="Center"/>
                                                    <TextBlock Text="{Binding Category}" FontSize="10" 
                                                               HorizontalAlignment="Center" Opacity="0.6"/>
                                                    <TextBlock Text="{Binding DueDate, StringFormat='Due: {0:MMM dd}'}" 
                                                               FontSize="10" HorizontalAlignment="Center" Opacity="0.6"/>
                                                </StackPanel>
                                                
                                                <Button Grid.Column="3" Grid.RowSpan="2" Content="Delete" 
                                                        Command="{Binding DataContext.DeleteTaskCommand, 
                                                                 RelativeSource={RelativeSource AncestorType=Window}}"
                                                        CommandParameter="{Binding}"
                                                        Background="LightCoral" Padding="8,4" Margin="5,0,0,0"/>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </ScrollViewer>
                        
                        <StackPanel Visibility="{Binding HasDisplayedTasks, Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                            <TextBlock Text="No tasks found" Style="{StaticResource EmptyStateTextStyle}"/>
                            <TextBlock Text="Add a task below to get started!" Style="{StaticResource EmptyStateTextStyle}" FontSize="12"/>
                        </StackPanel>
                        </Grid>
                    </TabItem>
                    
                    <TabItem Header="Table View" TabIndex="6">
                        <ListView ItemsSource="{Binding DisplayedTasks}">
                            <ListView.View>
                                <GridView>
                                    <GridViewColumn Header="✓" Width="30">
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <CheckBox IsChecked="{Binding IsCompleted}"
                                                          Command="{Binding DataContext.ToggleTaskCompletionCommand, 
                                                                   RelativeSource={RelativeSource AncestorType=Window}}"
                                                          CommandParameter="{Binding}"/>
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>
                                    <GridViewColumn Header="Name" DisplayMemberBinding="{Binding Name}" Width="200"/>
                                    <GridViewColumn Header="Priority" DisplayMemberBinding="{Binding Priority}" Width="80"/>
                                    <GridViewColumn Header="Category" DisplayMemberBinding="{Binding Category}" Width="100"/>
                                    <GridViewColumn Header="Due Date" DisplayMemberBinding="{Binding DueDate, StringFormat='{}{0:MMM dd, yyyy}'}" Width="120"/>
                                    <GridViewColumn Header="Actions" Width="80">
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <Button Content="Delete" 
                                                        Command="{Binding DataContext.DeleteTaskCommand, 
                                                                 RelativeSource={RelativeSource AncestorType=Window}}"
                                                        CommandParameter="{Binding}"
                                                        Background="LightCoral" Padding="5,2"/>
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>
                                </GridView>
                            </ListView.View>
                        </ListView>
                    </TabItem>
                    
                    <TabItem Header="Grid View" TabIndex="7">
                        <ScrollViewer>
                            <ItemsControl ItemsSource="{Binding DisplayedTasks}">
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <WrapPanel Orientation="Horizontal"/>
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border Background="LightBlue" BorderBrush="DarkBlue" BorderThickness="1" 
                                                CornerRadius="5" Margin="5" Padding="10" Width="200" Height="120">
                                            <Grid>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="*"/>
                                                    <RowDefinition Height="Auto"/>
                                                </Grid.RowDefinitions>
                                                
                                                <StackPanel Grid.Row="0" Orientation="Horizontal">
                                                    <CheckBox IsChecked="{Binding IsCompleted}"
                                                              Command="{Binding DataContext.ToggleTaskCompletionCommand, 
                                                                       RelativeSource={RelativeSource AncestorType=Window}}"
                                                              CommandParameter="{Binding}" Margin="0,0,5,0"/>
                                                    <TextBlock Text="{Binding Name}" FontWeight="Bold" FontSize="12"/>
                                                </StackPanel>
                                                
                                                <TextBlock Grid.Row="1" Text="{Binding Description}" 
                                                           TextWrapping="Wrap" FontSize="10" Margin="0,5"/>
                                                
                                                <Grid Grid.Row="2">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <TextBlock Grid.Column="0" Text="{Binding Priority, StringFormat='P:{0}'}" FontSize="10" VerticalAlignment="Center"/>
                                                    <Button Grid.Column="1" Content="X" 
                                                            Command="{Binding DataContext.DeleteTaskCommand, 
                                                                     RelativeSource={RelativeSource AncestorType=Window}}"
                                                            CommandParameter="{Binding}"
                                                            Background="Red" Foreground="White" 
                                                            Width="20" Height="20" Padding="0"/>
                                                </Grid>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </ScrollViewer>
                    </TabItem>
                </TabControl>
            </Grid>
        </Border>
        
        <Border Grid.Row="1" Grid.Column="1" Style="{StaticResource CardStyle}">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                
                <TextBlock Grid.Row="0" Text="Daily Routines" Style="{StaticResource SectionHeaderStyle}"/>
                
                <Grid Grid.Row="1" Margin="0,5,0,0">
                    <ScrollViewer Visibility="{Binding HasRoutines, Converter={StaticResource BooleanToVisibilityConverter}}">
                        <ItemsControl ItemsSource="{Binding Routines}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Background="LightYellow" BorderBrush="Orange" BorderThickness="1" 
                                        CornerRadius="3" Margin="2" Padding="5">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <CheckBox Grid.Column="0" IsChecked="{Binding IsCompleted}"
                                                  Command="{Binding DataContext.ToggleRoutineCompletionCommand, 
                                                           RelativeSource={RelativeSource AncestorType=Window}}"
                                                  CommandParameter="{Binding}" Margin="0,0,5,0"/>
                                        
                                        <TextBlock Grid.Column="1" Text="{Binding Name}" VerticalAlignment="Center"/>
                                        
                                        <Button Grid.Column="2" Content="X" 
                                                Command="{Binding DataContext.DeleteRoutineCommand, 
                                                         RelativeSource={RelativeSource AncestorType=Window}}"
                                                CommandParameter="{Binding}"
                                                Background="Red" Foreground="White" 
                                                Width="18" Height="18" Padding="0" FontSize="10"/>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </ScrollViewer>
                
                <StackPanel Visibility="{Binding HasRoutines, Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                    <TextBlock Text="No daily routines" Style="{StaticResource EmptyStateTextStyle}"/>
                    <TextBlock Text="Add a routine below!" Style="{StaticResource EmptyStateTextStyle}" FontSize="12"/>
                </StackPanel>
                </Grid>
                
                <StackPanel Grid.Row="2" Margin="0,10,0,0">
                    <Label Content="_Routine Name:" Target="{Binding ElementName=RoutineNameTextBox}"/>
                    <TextBox x:Name="RoutineNameTextBox"
                             Text="{Binding NewRoutineName, UpdateSourceTrigger=PropertyChanged}" 
                             Margin="0,2,0,2"
                             TabIndex="8"
                             AutomationProperties.Name="Routine Name"
                             AutomationProperties.HelpText="Enter the name of the new daily routine"
                             MaxLength="100"/>
                    <TextBlock Text="{Binding RoutineNameValidationMessage}" 
                               Style="{StaticResource ValidationTextStyle}"
                               Visibility="{Binding RoutineNameValidationMessage, Converter={StaticResource StringToVisibilityConverter}}"
                               AutomationProperties.LiveSetting="Assertive"/>
                    <Button Content="Add _Routine" Command="{Binding AddRoutineCommand}" 
                            Background="Orange" Foreground="White" Padding="5" Margin="0,5,0,0"
                            TabIndex="9"
                            AutomationProperties.Name="Add Routine"
                            AutomationProperties.HelpText="Add the new routine to the daily routines list"/>
                </StackPanel>
            </Grid>
        </Border>
        
        <Border Grid.Row="2" Grid.ColumnSpan="2" Style="{StaticResource CardStyle}" Margin="0,10,0,0">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="2*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                
                <TextBlock Grid.ColumnSpan="6" Text="Add New Task" Style="{StaticResource SectionHeaderStyle}"/>
                
                <StackPanel Grid.Row="1" Grid.Column="0" Margin="5">
                    <Label Content="Task _Name:" Target="{Binding ElementName=TaskNameTextBox}"/>
                    <TextBox x:Name="TaskNameTextBox" 
                             Text="{Binding NewTaskName, UpdateSourceTrigger=PropertyChanged}" 
                             Margin="0,2"
                             TabIndex="10"
                             AutomationProperties.Name="Task Name"
                             AutomationProperties.HelpText="Enter the name of the new task"
                             MaxLength="100"/>
                    <TextBlock Text="{Binding TaskNameValidationMessage}" 
                               Style="{StaticResource ValidationTextStyle}"
                               Visibility="{Binding TaskNameValidationMessage, Converter={StaticResource StringToVisibilityConverter}}"
                               AutomationProperties.LiveSetting="Assertive"/>
                    <Label Content="_Description:" Margin="0,5,0,0" Target="{Binding ElementName=TaskDescriptionTextBox}"/>
                    <TextBox x:Name="TaskDescriptionTextBox"
                             Text="{Binding NewTaskDescription, UpdateSourceTrigger=PropertyChanged}" 
                             Height="40" TextWrapping="Wrap" AcceptsReturn="True" Margin="0,2"
                             TabIndex="11"
                             AutomationProperties.Name="Task Description"
                             AutomationProperties.HelpText="Enter an optional description for the task"
                             MaxLength="500"/>
                </StackPanel>
                
                <StackPanel Grid.Row="1" Grid.Column="1" Margin="5">
                    <Label Content="_Priority (1-10):" Target="{Binding ElementName=PrioritySlider}"/>
                    <Slider x:Name="PrioritySlider"
                            Value="{Binding NewTaskPriority}" Minimum="1" Maximum="10" 
                            TickFrequency="1" IsSnapToTickEnabled="True" Margin="0,2"
                            TabIndex="12"
                            AutomationProperties.Name="Task Priority"
                            AutomationProperties.HelpText="Set the priority level from 1 to 10"
                            ToolTip="Use arrow keys or click to adjust priority level"/>
                    <TextBlock Text="{Binding NewTaskPriority}" HorizontalAlignment="Center"
                               AutomationProperties.LiveSetting="Polite"/>
                </StackPanel>
                
                <StackPanel Grid.Row="1" Grid.Column="2" Margin="5">
                    <Label Content="D_ue Date:" Target="{Binding ElementName=DueDatePicker}"/>
                    <DatePicker x:Name="DueDatePicker"
                                SelectedDate="{Binding NewTaskDueDate}" Margin="0,2"
                                TabIndex="13"
                                AutomationProperties.Name="Due Date"
                                AutomationProperties.HelpText="Select an optional due date for the task"
                                ToolTip="Click to open date picker or type date directly"/>
                </StackPanel>
                
                <StackPanel Grid.Row="1" Grid.Column="3" Margin="5">
                    <Label Content="Cat_egory:" Target="{Binding ElementName=CategoryComboBox2}"/>
                    <ComboBox x:Name="CategoryComboBox2"
                              ItemsSource="{Binding AllCategories}" 
                              SelectedItem="{Binding NewTaskCategory}" 
                              IsEditable="True" Margin="0,2"
                              TabIndex="14"
                              AutomationProperties.Name="Task Category"
                              AutomationProperties.HelpText="Select or enter a category for the task"
                              ToolTip="Select existing category or type new category name"/>
                </StackPanel>
                
                <Button Grid.Row="1" Grid.Column="4" Content="_Add Task" 
                        Command="{Binding AddTaskCommand}" 
                        Background="Green" Foreground="White" 
                        Margin="10" Padding="15,10" VerticalAlignment="Bottom"
                        TabIndex="15"
                        AutomationProperties.Name="Add Task"
                        AutomationProperties.HelpText="Add the new task to the list"
                        ToolTip="Add the new task to the list (Ctrl+N)"/>
            </Grid>
        </Border>
    </Grid>
</Window>
